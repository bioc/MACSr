<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>bdgpeakcall — bdgpeakcall • MACSr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="bdgpeakcall — bdgpeakcall"><meta property="og:description" content="Call peaks from bedGraph output. Note: All regions on the same
chromosome in the bedGraph file should be continuous so only
bedGraph files from MACS3 are accpetable."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-1');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MACSr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/MACSr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/macs3-project/MACSr" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>bdgpeakcall</h1>

    <div class="hidden name"><code>bdgpeakcall.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Call peaks from bedGraph output. Note: All regions on the same
chromosome in the bedGraph file should be continuous so only
bedGraph files from MACS3 are accpetable.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bdgpeakcall</span><span class="op">(</span></span>
<span>  <span class="va">ifile</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  minlen <span class="op">=</span> <span class="fl">200L</span>,</span>
<span>  maxgap <span class="op">=</span> <span class="fl">30L</span>,</span>
<span>  call_summits <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cutoff_analysis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cutoff_analysis_max <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  cutoff_analysis_steps <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  trackline <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  outdir <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  oprefix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  outputfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">2L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-ifile">ifile<a class="anchor" aria-label="anchor" href="#arg-ifile"></a></dt>
<dd><p>MACS score in bedGraph. REQUIRED.</p></dd>


<dt id="arg-cutoff">cutoff<a class="anchor" aria-label="anchor" href="#arg-cutoff"></a></dt>
<dd><p>Cutoff depends on which method you used for score track. If the file contains pvalue scores from MACS3, score 5 means pvalue 1e-5. Regions with signals lower than cutoff will not be considerred as enriched regions. DEFAULT: 5</p></dd>


<dt id="arg-minlen">minlen<a class="anchor" aria-label="anchor" href="#arg-minlen"></a></dt>
<dd><p>minimum length of peak, better to set it as d
value. DEFAULT: 200", default = 200.</p></dd>


<dt id="arg-maxgap">maxgap<a class="anchor" aria-label="anchor" href="#arg-maxgap"></a></dt>
<dd><p>maximum gap between significant points in a peak,
better to set it as tag size. DEFAULT: 30", default = 30.</p></dd>


<dt id="arg-call-summits">call_summits<a class="anchor" aria-label="anchor" href="#arg-call-summits"></a></dt>
<dd><p>If set, MACS will use a more sophisticated
approach to find all summits in each enriched peak region
DEFAULT: False",default=False.</p></dd>


<dt id="arg-cutoff-analysis">cutoff_analysis<a class="anchor" aria-label="anchor" href="#arg-cutoff-analysis"></a></dt>
<dd><p>While set, bdgpeakcall will analyze number
or total length of peaks that can be called by different cutoff
then output a summary table to help user decide a better
cutoff. Note, minlen and maxgap may affect the
results. DEFAULT: False</p></dd>


<dt id="arg-cutoff-analysis-max">cutoff_analysis_max<a class="anchor" aria-label="anchor" href="#arg-cutoff-analysis-max"></a></dt>
<dd><p>The maximum cutoff score for performing cutoff analysis. Together with –cutoff-analysis-steps, the resolution in the final report can be controlled. Please check the description in –cutoff-analysis-steps for detail. DEFAULT: 100</p></dd>


<dt id="arg-cutoff-analysis-steps">cutoff_analysis_steps<a class="anchor" aria-label="anchor" href="#arg-cutoff-analysis-steps"></a></dt>
<dd><p>Steps for performing cutoff analysis. It will be used to decide which cutoff value should be included in the final report. Larger the value, higher resolution the cutoff analysis can be. The cutoff analysis function will first find the smallest (at least 0) and the largest (controlled by –cutoff-analysis-max) score in the data, then break the range of score into <code>CUTOFF_ANALYSIS_STEPS</code> intervals. It will then use each score as cutoff to call peaks and calculate the total number of candidate peaks, the total basepairs of peaks, and the average length of peak in basepair. Please note that the final report ideally should include <code>CUTOFF_ANALYSIS_STEPS</code> rows, but in practice, if the cutoff yield zero peak, the row for that value won't be included.  DEFAULT: 100</p></dd>


<dt id="arg-trackline">trackline<a class="anchor" aria-label="anchor" href="#arg-trackline"></a></dt>
<dd><p>Tells MACS not to include trackline with bedGraph files. The trackline is used by UCSC for the options for display.</p></dd>


<dt id="arg-outdir">outdir<a class="anchor" aria-label="anchor" href="#arg-outdir"></a></dt>
<dd><p>The output directory.</p></dd>


<dt id="arg-oprefix">oprefix<a class="anchor" aria-label="anchor" href="#arg-oprefix"></a></dt>
<dd><p>Output file prefix. Actual files will be named as
PREFIX_cond1.bed, PREFIX_cond2.bed and
PREFIX_common.bed. Mutually exclusive with -o/–ofile.</p></dd>


<dt id="arg-outputfile">outputfile<a class="anchor" aria-label="anchor" href="#arg-outputfile"></a></dt>
<dd><p>Output file name. Mutually exclusive with –o-prefix</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p>Whether to capture logs.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Set verbose level of runtime message. 0: only show
critical message, 1: show additional warning message, 2: show
process information, 3: show debug messages. DEFAULT:2</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>macsList</code> object.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">eh</span> <span class="op">&lt;-</span> <span class="fu">ExperimentHub</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ExperimentHub/man/ExperimentHub-class.html" class="external-link">ExperimentHub</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CHIP</span> <span class="op">&lt;-</span> <span class="va">eh</span><span class="op">[[</span><span class="st">"EH4558"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> see ?MACSdata and browseVignettes('MACSdata') for documentation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> loading from cache</span>
<span class="r-in"><span><span class="va">CTRL</span> <span class="op">&lt;-</span> <span class="va">eh</span><span class="op">[[</span><span class="st">"EH4563"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> see ?MACSdata and browseVignettes('MACSdata') for documentation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> loading from cache</span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="pileup.html">pileup</a></span><span class="op">(</span><span class="va">CHIP</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             outputfile <span class="op">=</span> <span class="st">"pileup_ChIP_bed.bdg"</span>, format <span class="op">=</span> <span class="st">"BED"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="pileup.html">pileup</a></span><span class="op">(</span><span class="va">CTRL</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             outputfile <span class="op">=</span> <span class="st">"pileup_CTRL_bed.bdg"</span>, format <span class="op">=</span> <span class="st">"BED"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu"><a href="bdgcmp.html">bdgcmp</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">outputs</span>, <span class="va">p2</span><span class="op">$</span><span class="va">outputs</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             oprefix <span class="op">=</span> <span class="st">"bdgcmp"</span>, pseudocount <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">"FE"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">bdgpeakcall</span><span class="op">(</span><span class="va">c1</span><span class="op">$</span><span class="va">outputs</span>, cutoff <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>            outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, outputfile <span class="op">=</span> <span class="st">"bdgpeakcall"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> macsList class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $outputs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  /tmp/RtmpkYWDbh/bdgpeakcall </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $arguments: ifile, cutoff, outdir, outputfile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $log:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Philippa Doherty, Qiang Hu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

