<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>hmmratac — hmmratac • MACSr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="hmmratac — hmmratac"><meta property="og:description" content="Dedicated peak calling based on Hidden Markov Model for ATAC-seq
data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MACSr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/MACSr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/macs3-project/MACSr" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>hmmratac</h1>
    
    <div class="hidden name"><code>hmmratac.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Dedicated peak calling based on Hidden Markov Model for ATAC-seq
data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hmmratac</span><span class="op">(</span></span>
<span>  <span class="va">bam</span>,</span>
<span>  outdir <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"NA"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cutoff_analysis_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  em_skip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  em_means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="fl">600</span><span class="op">)</span>,</span>
<span>  em_stddevs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  min_frag_p <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  hmm_binsize <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  hmm_lower <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  hmm_upper <span class="op">=</span> <span class="fl">20L</span>,</span>
<span>  hmm_maxTrain <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  hmm_training_flanking <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  hmm_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hmm_training_regions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hmm_randomSeed <span class="op">=</span> <span class="fl">10151</span>,</span>
<span>  hmm_modelonly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prescan_cutoff <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  openregion_minlen <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  pileup_short <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keepduplicates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  blacklist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_digested <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_likelihoods <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_states <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_train <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  decoding_steps <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  buffer_size <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>bam</dt>
<dd><p>Sorted BAM files containing the ATAC-seq reads. If
multiple files are given as '-t A B C', then they will all be
read and pooled together. REQUIRED.</p></dd>


<dt>outdir</dt>
<dd><p>If specified all output files will be written to that
directory. Default: the current working directory</p></dd>


<dt>name</dt>
<dd><p>Name for this experiment, which will be used as a
prefix to generate output file names. DEFAULT: "NA"</p></dd>


<dt>verbose</dt>
<dd><p>Set verbose level of runtime message. 0: only show
critical message, 1: show additional warning message, 2: show
process information, 3: show debug messages. DEFAULT:2</p></dd>


<dt>log</dt>
<dd><p>Whether to capture logs.</p></dd>


<dt>cutoff_analysis_only</dt>
<dd><p>Only run the cutoff analysis and output
a report.  After generating the report, the process will stop.
The report will help user decide the three crucial parameters
for <code>-l</code>, <code>-u</code>, and <code>-c</code>. So it's highly recommanded to run
this first! Please read the report and instructions in <code>Choices of cutoff values</code> on how to decide the three crucial
parameters.</p></dd>


<dt>em_skip</dt>
<dd><p>Do not perform EM training on the fragment
distribution. If set, EM_MEANS and EM.STDDEVS will be used
instead. Default: False</p></dd>


<dt>em_means</dt>
<dd><p>Comma separated list of initial mean values for the
fragment distribution for short fragments, mono-, di-, and
tri-nucleosomal fragments. Default: 50 200 400 600</p></dd>


<dt>em_stddevs</dt>
<dd><p>Comma separated list of initial standard
deviation values for fragment distribution for short fragments,
mono-, di-, and tri-nucleosomal fragments. Default: 20 20 20 20</p></dd>


<dt>min_frag_p</dt>
<dd><p>We will exclude the abnormal fragments that can't
be assigned to any of the four signal tracks. After we use EM
to find the means and stddevs of the four distributions, we
will calculate the likelihood that a given fragment length fit
any of the four using normal distribution. The criteria we will
use is that if a fragment length has less than MIN_FRAG_P
probability to be like either of short, mono, di, or tri-nuc
fragment, we will exclude it while generating the four signal
tracks for later HMM training and prediction.  The value should
be between 0 and 1. Larger the value, more abnormal fragments
will be allowed. So if you want to include more 'ideal'
fragments, make this value smaller. Default = 0.001</p></dd>


<dt>hmm_binsize</dt>
<dd><p>Size of the bins to split the pileup signals for
training and decoding with Hidden Markov Model. Must &gt;=
1. Smaller the binsize, higher the resolution of the results,
slower the process. Default = 10</p></dd>


<dt>hmm_lower</dt>
<dd><p>Upper limit on fold change range for choosing
training sites. Default: 20</p></dd>


<dt>hmm_upper</dt>
<dd><p>Lower limit on fold change range for choosing
training sites. Default: 10</p></dd>


<dt>hmm_maxTrain</dt>
<dd><p>Maximum number of training regions to
use. Default: 1000</p></dd>


<dt>hmm_training_flanking</dt>
<dd><p>Training regions will be expanded to
both side with this number of basepairs. The purpose is to
include more background regions. Default: 1000</p></dd>


<dt>hmm_file</dt>
<dd><p>A JSON file generated from previous HMMRATAC run to
use instead of creating new one. When provided, HMM training
will be skipped. Default: NA</p></dd>


<dt>hmm_training_regions</dt>
<dd><p>Filename of training regions
(previously was BED_file) to use for training HMM, instead of
using foldchange settings to select. Default: NA</p></dd>


<dt>hmm_randomSeed</dt>
<dd><p>Seed to set for random sampling of training
regions. Default: 10151</p></dd>


<dt>hmm_modelonly</dt>
<dd><p>Stop the program after generating model. Use
this option to generate HMM model ONLY, which can be later
applied with <code>--model</code>. Default: False</p></dd>


<dt>prescan_cutoff</dt>
<dd><p>The fold change cutoff for prescanning
candidate regions in the whole dataset. Then we will use HMM to
predict states on these candidate regions. Higher the prescan
cutoff, fewer regions will be considered. Must &gt; 1. Default:
1.2</p></dd>


<dt>openregion_minlen</dt>
<dd><p>Minimum length of open region to call
accessible regions. Must be larger than 0. If it is set as 0,
it means no filtering on the length of the open regions
called. Please note that, when bin size is small, setting a too
small OPENREGION_MINLEN will bring a lot of false
positives. Default: 100</p></dd>


<dt>pileup_short</dt>
<dd><p>By default, HMMRATAC will pileup all fragments
in order to identify regions for training and candidate regions
for decoding. When this option is on, it will pileup only the
short fragments to do so. Although it sounds a good idea since
we assume that open region should have a lot of short
fragments, it may be possible that the overall short fragments
are too few to be useful. Default: False</p></dd>


<dt>keepduplicates</dt>
<dd><p>Keep duplicate reads from analysis. By
default, duplicate reads will be removed. Default: False</p></dd>


<dt>blacklist</dt>
<dd><p>Filename of blacklisted regions to exclude
(previously was BED_file). Examples are those from
ENCODE. Default: NA</p></dd>


<dt>save_digested</dt>
<dd><p>Save the digested ATAC signals of short-,
mono-, di-, and tri- signals in three BedGraph files with the
names NAME_short.bdg, NAME_mono.bdg, NAME_di.bdg, and
NAME_tri.bdg. DEFAULT: False</p></dd>


<dt>save_likelihoods</dt>
<dd><p>Save the likelihoods to each state
annotation in three BedGraph files, named with NAME_open.bdg
for open states, NAME_nuc.bdg for nucleosomal states, and
NAME_bg.bdg for the background states. DEFAULT: False</p></dd>


<dt>save_states</dt>
<dd><p>Save all open and nucleosomal state annotations
into a BED file with the name NAME_states.bed. DEFAULT: False</p></dd>


<dt>save_train</dt>
<dd><p>Save the training regions and training data into
NAME_training_regions.bed and NAME_training_data.txt. Default:
False</p></dd>


<dt>decoding_steps</dt>
<dd><p>Number of candidate regions to be decoded at
a time. The HMM model will be applied with Viterbi to find the
optimal state path in each region. bigger the number,
'possibly' faster the decoding process, 'definitely' larger the
memory usage. Default: 1000.</p></dd>


<dt>buffer_size</dt>
<dd><p>Buffer size for incrementally increasing
internal array size to store reads alignment information. In
most cases, you don't have to change this parameter. However,
if there are large number of chromosomes/contigs/scaffolds in
your alignment, it's recommended to specify a smaller buffer
size in order to decrease memory usage (but it will take longer
time to read alignment files). Minimum memory requested for
reading an alignment file is about # of CHROMOSOME *
BUFFER_SIZE * 8 Bytes. DEFAULT: 100000</p></dd>


<dt>...</dt>
<dd><p>More options for macs2.</p></dd>

</dl></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Qiang Hu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

