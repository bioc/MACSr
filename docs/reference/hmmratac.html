<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>hmmratac — hmmratac • MACSr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="hmmratac — hmmratac"><meta property="og:description" content="Dedicated peak calling based on Hidden Markov Model for ATAC-seq
data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-1');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MACSr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/MACSr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/macs3-project/MACSr" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>hmmratac</h1>

    <div class="hidden name"><code>hmmratac.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Dedicated peak calling based on Hidden Markov Model for ATAC-seq
data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hmmratac</span><span class="op">(</span></span>
<span>  <span class="va">input_file</span>,</span>
<span>  outdir <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"NA"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cutoff_analysis_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cutoff_analysis_max <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  cutoff_analysis_steps <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"BAMPE"</span>,</span>
<span>  em_skip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  em_means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="fl">600</span><span class="op">)</span>,</span>
<span>  em_stddevs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  min_frag_p <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  hmm_binsize <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  hmm_lower <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  hmm_upper <span class="op">=</span> <span class="fl">20L</span>,</span>
<span>  hmm_maxTrain <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  hmm_training_flanking <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  hmm_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hmm_training_regions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hmm_randomSeed <span class="op">=</span> <span class="fl">10151</span>,</span>
<span>  hmm_modelonly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  hmm_type <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  prescan_cutoff <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  openregion_minlen <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  pileup_short <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keepduplicates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  blacklist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_digested <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_likelihoods <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_states <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_train <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  decoding_steps <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  buffer_size <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-input-file">input_file<a class="anchor" aria-label="anchor" href="#arg-input-file"></a></dt>
<dd><p>Input files containing the aligment results for ATAC-seq paired end reads. If multiple files are given as '-t A B C', then they will all be read and pooled together. The file should be in BAMPE or BEDPE format (aligned in paired end mode). Files can be gzipped. Note: all files should be in the same format! REQUIRED.</p></dd>


<dt id="arg-outdir">outdir<a class="anchor" aria-label="anchor" href="#arg-outdir"></a></dt>
<dd><p>If specified all output files will be written to that
directory. Default: the current working directory</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>Name for this experiment, which will be used as a
prefix to generate output file names. DEFAULT: "NA"</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Set verbose level of runtime message. 0: only show
critical message, 1: show additional warning message, 2: show
process information, 3: show debug messages. DEFAULT:2</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p>Whether to capture logs.</p></dd>


<dt id="arg-cutoff-analysis-only">cutoff_analysis_only<a class="anchor" aria-label="anchor" href="#arg-cutoff-analysis-only"></a></dt>
<dd><p>Only run the cutoff analysis and output a report. After generating the report, the process will stop. By default, the cutoff analysis will be included in the whole process, but won't quit after the report is generated. The report will help user decide the three crucial parameters for <code>-l</code>, <code>-u</code>, and <code>-c</code>. So it's highly recommanded to run this first! Please read the report and instructions in <code>Choices of cutoff values</code> on how to decide the three crucial parameters. The resolution of cutoff analysis can be controlled by –cutoff-analysis-max and –cutoff-analysis-steps options.</p></dd>


<dt id="arg-cutoff-analysis-max">cutoff_analysis_max<a class="anchor" aria-label="anchor" href="#arg-cutoff-analysis-max"></a></dt>
<dd><p>The maximum cutoff score for performing cutoff analysis. Together with –cutoff-analysis-steps, the resolution in the final report can be controlled. Please check the description in –cutoff-analysis-steps for detail. DEFAULT: 100</p></dd>


<dt id="arg-cutoff-analysis-steps">cutoff_analysis_steps<a class="anchor" aria-label="anchor" href="#arg-cutoff-analysis-steps"></a></dt>
<dd><p>Steps for performing cutoff analysis. It will be used to decide which cutoff value should be included in the final report. Larger the value, higher resolution the cutoff analysis can be. The cutoff analysis function will first find the smallest (at least 0) and the largest (controlled by –cutoff-analysis-max) foldchange score in the data, then break the range of foldchange score into <code>CUTOFF_ANALYSIS_STEPS</code> intervals. It will then use each foldchange score as cutoff to call peaks and calculate the total number of candidate peaks, the total basepairs of peaks, and the average length of peak in basepair. Please note that the final report ideally should include <code>CUTOFF_ANALYSIS_STEPS</code> rows, but in practice, if the foldchange cutoff yield zero peak, the row for that foldchange value won't be included.  DEFAULT: 100</p></dd>


<dt id="arg-format">format<a class="anchor" aria-label="anchor" href="#arg-format"></a></dt>
<dd><p>Format of input files, \"BAMPE\" or \"BEDPE\". If there are multiple files, they should be in the same format – either BAMPE or BEDPE. Please check the definition in README. Also please note that the BEDPE only contains three columns – chromosome, left position of the whole pair, right position of the whole pair– and is NOT the same BEDPE format used by BEDTOOLS. To convert BAMPE to BEDPE, you can use this command <code>macs3 filterdup --keep-dup all -f BAMPE -i input.bam -o output.bedpe</code>. DEFAULT: \"BAMPE\"</p></dd>


<dt id="arg-em-skip">em_skip<a class="anchor" aria-label="anchor" href="#arg-em-skip"></a></dt>
<dd><p>Do not perform EM training on the fragment distribution. If set, EM_MEANS and EM.STDDEVS will be used instead. Default: False</p></dd>


<dt id="arg-em-means">em_means<a class="anchor" aria-label="anchor" href="#arg-em-means"></a></dt>
<dd><p>Comma separated list of initial mean values for the fragment distribution for short fragments, mono-, di-, and tri-nucleosomal fragments. Default: 50 200 400 600</p></dd>


<dt id="arg-em-stddevs">em_stddevs<a class="anchor" aria-label="anchor" href="#arg-em-stddevs"></a></dt>
<dd><p>Comma separated list of initial standard deviation values for fragment distribution for short fragments, mono-, di-, and tri-nucleosomal fragments. Default: 20 20 20 20</p></dd>


<dt id="arg-min-frag-p">min_frag_p<a class="anchor" aria-label="anchor" href="#arg-min-frag-p"></a></dt>
<dd><p>We will exclude the abnormal fragments that can't be assigned to any of the four signal tracks. After we use EM to find the means and stddevs of the four distributions, we will calculate the likelihood that a given fragment length fit any of the four using normal distribution. The criteria we will use is that if a fragment length has less than MIN_FRAG_P probability to be like either of short, mono, di, or tri-nuc fragment, we will exclude it while generating the four signal tracks for later HMM training and prediction. The value should be between 0 and 1. Larger the value, more abnormal fragments will be allowed. So if you want to include more 'ideal' fragments, make this value smaller. Default = 0.001</p></dd>


<dt id="arg-hmm-binsize">hmm_binsize<a class="anchor" aria-label="anchor" href="#arg-hmm-binsize"></a></dt>
<dd><p>Size of the bins to split the pileup signals for training and decoding with Hidden Markov Model. Must &gt;= 1. Smaller the binsize, higher the resolution of the results, slower the process. Default = 10</p></dd>


<dt id="arg-hmm-lower">hmm_lower<a class="anchor" aria-label="anchor" href="#arg-hmm-lower"></a></dt>
<dd><p>Lower limit on fold change range for choosing training sites. This is an important parameter for training so please read. The purpose of this parameter is to ONLY INCLUDE those chromatin regions having ordinary enrichment so we can get training samples to learn the common features through HMM. It's highly recommended to run the <code>--cutoff-analysis-only</code> first to decide the lower cutoff <code>-l</code>, the upper cutoff <code>-u</code>, and the pre-scanning cutoff <code>-c</code>. The lower cutoff should be the cutoff in the cutoff analysis result that can capture moderate number ( about 10k ) of peaks with normal width ( average length 500-1000bps long). Default: 10</p></dd>


<dt id="arg-hmm-upper">hmm_upper<a class="anchor" aria-label="anchor" href="#arg-hmm-upper"></a></dt>
<dd><p>Upper limit on fold change range for choosing training sites. This is an important parameter for training so please read. The purpose of this parameter is to EXCLUDE those unusually highly enriched chromatin regions so we can get training samples in 'ordinary' regions instead. It's highly recommended to run the <code>--cutoff-analysis-only</code> first to decide the lower cutoff <code>-l</code>, the upper cutoff <code>-u</code>, and the pre-scanning cutoff <code>-c</code>. The upper cutoff should be the cutoff in the cutoff analysis result that can capture some (typically hundreds of) extremely high enrichment and unusually wide peaks. Default: 20</p></dd>


<dt id="arg-hmm-maxtrain">hmm_maxTrain<a class="anchor" aria-label="anchor" href="#arg-hmm-maxtrain"></a></dt>
<dd><p>Maximum number of training regions to use. After we identify the training regions between <code>-l</code> and <code>-u</code>, the lower and upper cutoffs, we will randomly pick this number of regions for training. Default: 1000</p></dd>


<dt id="arg-hmm-training-flanking">hmm_training_flanking<a class="anchor" aria-label="anchor" href="#arg-hmm-training-flanking"></a></dt>
<dd><p>Training regions will be expanded to both side with this number of basepairs. The purpose is to include more background regions. Default: 1000</p></dd>


<dt id="arg-hmm-file">hmm_file<a class="anchor" aria-label="anchor" href="#arg-hmm-file"></a></dt>
<dd><p>A JSON file generated from previous HMMRATAC run to
use instead of creating new one. When provided, HMM training
will be skipped. Default: NA</p></dd>


<dt id="arg-hmm-training-regions">hmm_training_regions<a class="anchor" aria-label="anchor" href="#arg-hmm-training-regions"></a></dt>
<dd><p>Filename of training regions
(previously was BED_file) to use for training HMM, instead of
using foldchange settings to select. Default: NA</p></dd>


<dt id="arg-hmm-randomseed">hmm_randomSeed<a class="anchor" aria-label="anchor" href="#arg-hmm-randomseed"></a></dt>
<dd><p>Seed to set for random sampling of training
regions. Default: 10151</p></dd>


<dt id="arg-hmm-modelonly">hmm_modelonly<a class="anchor" aria-label="anchor" href="#arg-hmm-modelonly"></a></dt>
<dd><p>Stop the program after generating model. Use
this option to generate HMM model ONLY, which can be later
applied with hmm_file option. Default: False</p></dd>


<dt id="arg-hmm-type">hmm_type<a class="anchor" aria-label="anchor" href="#arg-hmm-type"></a></dt>
<dd><p>Use hmm_type to select a Gaussian ('gaussian') or Poisson ('poisson') model for the hidden markov model in HMMRATAC. Default: 'gaussian'.</p></dd>


<dt id="arg-prescan-cutoff">prescan_cutoff<a class="anchor" aria-label="anchor" href="#arg-prescan-cutoff"></a></dt>
<dd><p>The fold change cutoff for prescanning candidate regions in the whole dataset. Then we will use HMM to predict/decode states on these candidate regions. Higher the prescan cutoff, fewer regions will be considered. Must &gt; 1. This is an important parameter for decoding so please read. The purpose of this parameter is to EXCLUDE those chromatin regions having noises/random enrichment so we can have a large number of possible regions to predict the HMM states. It's highly recommended to run the <code>--cutoff-analysis-only</code> first to decide the lower cutoff <code>-l</code>, the upper cutoff <code>-u</code>, and the pre-scanning cutoff <code>-c</code>. The pre-scanning cutoff should be the cutoff close to the BOTTOM of the cutoff analysis result that can capture large number of possible peaks with normal length (average length 500-1000bps). In most cases, please do not pick a cutoff too low that capture almost all the background noises from the data. Default: 1.2</p></dd>


<dt id="arg-openregion-minlen">openregion_minlen<a class="anchor" aria-label="anchor" href="#arg-openregion-minlen"></a></dt>
<dd><p>Minimum length of open region to call
accessible regions. Must be larger than 0. If it is set as 0,
it means no filtering on the length of the open regions
called. Please note that, when bin size is small, setting a too
small OPENREGION_MINLEN will bring a lot of false
positives. Default: 100</p></dd>


<dt id="arg-pileup-short">pileup_short<a class="anchor" aria-label="anchor" href="#arg-pileup-short"></a></dt>
<dd><p>By default, HMMRATAC will pileup all fragments
in order to identify regions for training and candidate regions
for decoding. When this option is on, it will pileup only the
short fragments to do so. Although it sounds a good idea since
we assume that open region should have a lot of short
fragments, it may be possible that the overall short fragments
are too few to be useful. Default: False</p></dd>


<dt id="arg-keepduplicates">keepduplicates<a class="anchor" aria-label="anchor" href="#arg-keepduplicates"></a></dt>
<dd><p>Keep duplicate reads from analysis. By
default, duplicate reads will be removed. Default: False</p></dd>


<dt id="arg-blacklist">blacklist<a class="anchor" aria-label="anchor" href="#arg-blacklist"></a></dt>
<dd><p>Filename of blacklisted regions to exclude
(previously was BED_file). Examples are those from
ENCODE. Default: NA</p></dd>


<dt id="arg-save-digested">save_digested<a class="anchor" aria-label="anchor" href="#arg-save-digested"></a></dt>
<dd><p>Save the digested ATAC signals of short-,
mono-, di-, and tri- signals in three BedGraph files with the
names NAME_short.bdg, NAME_mono.bdg, NAME_di.bdg, and
NAME_tri.bdg. DEFAULT: False</p></dd>


<dt id="arg-save-likelihoods">save_likelihoods<a class="anchor" aria-label="anchor" href="#arg-save-likelihoods"></a></dt>
<dd><p>Save the likelihoods to each state
annotation in three BedGraph files, named with NAME_open.bdg
for open states, NAME_nuc.bdg for nucleosomal states, and
NAME_bg.bdg for the background states. DEFAULT: False</p></dd>


<dt id="arg-save-states">save_states<a class="anchor" aria-label="anchor" href="#arg-save-states"></a></dt>
<dd><p>Save all open and nucleosomal state annotations
into a BED file with the name NAME_states.bed. DEFAULT: False</p></dd>


<dt id="arg-save-train">save_train<a class="anchor" aria-label="anchor" href="#arg-save-train"></a></dt>
<dd><p>Save the training regions and training data into
NAME_training_regions.bed and NAME_training_data.txt. Default:
False</p></dd>


<dt id="arg-decoding-steps">decoding_steps<a class="anchor" aria-label="anchor" href="#arg-decoding-steps"></a></dt>
<dd><p>Number of candidate regions to be decoded at
a time. The HMM model will be applied with Viterbi to find the
optimal state path in each region. bigger the number,
'possibly' faster the decoding process, 'definitely' larger the
memory usage. Default: 1000.</p></dd>


<dt id="arg-buffer-size">buffer_size<a class="anchor" aria-label="anchor" href="#arg-buffer-size"></a></dt>
<dd><p>Buffer size for incrementally increasing
internal array size to store reads alignment information. In
most cases, you don't have to change this parameter. However,
if there are large number of chromosomes/contigs/scaffolds in
your alignment, it's recommended to specify a smaller buffer
size in order to decrease memory usage (but it will take longer
time to read alignment files). Minimum memory requested for
reading an alignment file is about # of CHROMOSOME *
BUFFER_SIZE * 8 Bytes. DEFAULT: 100000</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>More options for macs3.</p></dd>

</dl></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Philippa Doherty, Qiang Hu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

