<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>bdgcmp — bdgcmp • MACSr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="bdgcmp — bdgcmp"><meta property="og:description" content="Deduct noise by comparing two signal tracks in bedGraph. Note: All
regions on the same chromosome in the bedGraph file should be
continuous so only bedGraph files from MACS3 are accpetable."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MACSr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/MACSr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/macs3-project/MACSr" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>bdgcmp</h1>
    
    <div class="hidden name"><code>bdgcmp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Deduct noise by comparing two signal tracks in bedGraph. Note: All
regions on the same chromosome in the bedGraph file should be
continuous so only bedGraph files from MACS3 are accpetable.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bdgcmp</span><span class="op">(</span></span>
<span>  <span class="va">tfile</span>,</span>
<span>  <span class="va">cfile</span>,</span>
<span>  sfactor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pseudocount <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ppois"</span>, <span class="st">"qpois"</span>, <span class="st">"subtract"</span>, <span class="st">"logFE"</span>, <span class="st">"FE"</span>, <span class="st">"logLR"</span>, <span class="st">"slogLR"</span>, <span class="st">"max"</span><span class="op">)</span>,</span>
<span>  oprefix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  outputfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  outdir <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">2L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>tfile</dt>
<dd><p>Treatment bedGraph file, e.g. *_treat_pileup.bdg from
MACSv2. REQUIRED</p></dd>


<dt>cfile</dt>
<dd><p>Control bedGraph file, e.g. *_control_lambda.bdg from
MACSv2. REQUIRED</p></dd>


<dt>sfactor</dt>
<dd><p>Scaling factor for treatment and control track. Keep
it as 1.0 or default in most cases. Set it ONLY while you have
SPMR output from MACS3 callpeak, and plan to calculate scores
as MACS3 callpeak module. If you want to simulate 'callpeak'
w/o '--to-large', calculate effective smaller sample size after
filtering redudant reads in million (e.g., put 31.415926 if
effective reads are 31,415,926) and input it for '-S'; for
'callpeak --to-large', calculate effective reads in larger
sample. DEFAULT: 1.0</p></dd>


<dt>pseudocount</dt>
<dd><p>The pseudocount used for calculating logLR,
logFE or FE. The count will be applied after normalization of
sequencing depth. DEFAULT: 0.0, no pseudocount is applied.</p></dd>


<dt>method</dt>
<dd><p>Method to use while calculating a score in any bin by
comparing treatment value and control value. Available choices
are: ppois, qpois, subtract, logFE, logLR, and slogLR. They
represent Poisson Pvalue (-log10(pvalue) form) using control as
lambda and treatment as observation, q-value through a BH
process for poisson pvalues, subtraction from treatment, linear
scale fold enrichment, log10 fold enrichment(need to set
pseudocount), log10 likelihood between ChIP-enriched model and
open chromatin model(need to set pseudocount), symmetric log10
likelihood between two ChIP-enrichment models, or maximum value
between the two tracks. Default option is
ppois.",default="ppois".</p></dd>


<dt>oprefix</dt>
<dd><p>The PREFIX of output bedGraph file to write
scores. If it is given as A, and method is 'ppois', output file
will be A_ppois.bdg. Mutually exclusive with -o/--ofile.</p></dd>


<dt>outputfile</dt>
<dd><p>Output filename. Mutually exclusive with
--o-prefix. The number and the order of arguments for --ofile
must be the same as for -m.</p></dd>


<dt>outdir</dt>
<dd><p>The output directory.</p></dd>


<dt>log</dt>
<dd><p>Whether to capture logs.</p></dd>


<dt>verbose</dt>
<dd><p>Set verbose level. 0: only show critical message, 1:
show additional warning message, 2: show process information,
3: show debug messages. If you want to know where are the
duplicate reads, use 3. DEFAULT:2</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>macsList</code> object.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">eh</span> <span class="op">&lt;-</span> <span class="fu">ExperimentHub</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ExperimentHub/man/ExperimentHub-class.html" class="external-link">ExperimentHub</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CHIP</span> <span class="op">&lt;-</span> <span class="va">eh</span><span class="op">[[</span><span class="st">"EH4558"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> see ?MACSdata and browseVignettes('MACSdata') for documentation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> loading from cache</span>
<span class="r-in"><span><span class="va">CTRL</span> <span class="op">&lt;-</span> <span class="va">eh</span><span class="op">[[</span><span class="st">"EH4563"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> see ?MACSdata and browseVignettes('MACSdata') for documentation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> loading from cache</span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="pileup.html">pileup</a></span><span class="op">(</span><span class="va">CHIP</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             outputfile <span class="op">=</span> <span class="st">"pileup_ChIP_bed.bdg"</span>, format <span class="op">=</span> <span class="st">"BED"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [706 MB] # Existing file b'/tmp/RtmpEPj3Vo/pileup_ChIP_bed.bdg' will be replaced! </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [706 MB] # read alignment files... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [706 MB] # read treatment tags... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] tag size is determined as 101 bps </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] # tag size = 101 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] # total tags in alignment file: 49622 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] # Pileup alignment file, extend each read towards downstream direction with 200 bps </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] # Done! Check pileup_ChIP_bed.bdg </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="pileup.html">pileup</a></span><span class="op">(</span><span class="va">CTRL</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             outputfile <span class="op">=</span> <span class="st">"pileup_CTRL_bed.bdg"</span>, format <span class="op">=</span> <span class="st">"BED"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] # Existing file b'/tmp/RtmpEPj3Vo/pileup_CTRL_bed.bdg' will be replaced! </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] # read alignment files... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] # read treatment tags... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] tag size is determined as 101 bps </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] # tag size = 101 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] # total tags in alignment file: 50837 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] # Pileup alignment file, extend each read towards downstream direction with 200 bps </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] # Done! Check pileup_CTRL_bed.bdg </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu">bdgcmp</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">outputs</span>, <span class="va">p2</span><span class="op">$</span><span class="va">outputs</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             oprefix <span class="op">=</span> <span class="st">"bdgcmp"</span>, pseudocount <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">"FE"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] Read and build treatment bedGraph... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] Read and build control bedGraph... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] Build ScoreTrackII... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:08: [708 MB] Calculate scores comparing treatment and control by 'FE'... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:09: [708 MB] Write bedGraph of scores... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> INFO  @ 17 Nov 2023 13:42:09: [708 MB] Finished 'FE'! Please check '/tmp/RtmpEPj3Vo/bdgcmp_FE.bdg'! </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Qiang Hu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

