<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MACSr • MACSr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="MACSr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MACSr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/MACSr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/macs3-project/MACSr" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MACSr</h1>
            
      

      <div class="hidden name"><code>MACSr.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>With the improvement of sequencing techniques, chromatin
immunoprecipitation followed by high throughput sequencing (ChIP-Seq) is
getting popular to study genome-wide protein-DNA interactions. To
address the lack of powerful ChIP-Seq analysis method, we presented the
Model-based Analysis of ChIP-Seq (MACS), for identifying transcript
factor binding sites. MACS captures the influence of genome complexity
to evaluate the significance of enriched ChIP regions and MACS improves
the spatial resolution of binding sites through combining the
information of both sequencing tag position and orientation. MACS can be
easily used for ChIP-Seq data alone, or with a control sample with the
increase of specificity. Moreover, as a general peak-caller, MACS can
also be applied to any “DNA enrichment assays” if the question to be
asked is simply: where we can find significant reads coverage than the
random background.</p>
<p>This package is a wrapper of the MACS toolkit based on
<code>basilisk</code>.</p>
</div>
<div class="section level2">
<h2 id="load-the-package">Load the package<a class="anchor" aria-label="anchor" href="#load-the-package"></a>
</h2>
<p>The package is built on <a href="https://bioconductor.org/packages/release/bioc/html/basilisk.html" class="external-link">basilisk</a>.
The dependent python library <a href="https://github.com/macs3-project/MACS" class="external-link">macs3</a> will be installed
automatically inside its conda environment.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MACSr</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="macs3-functions">MACS3 functions<a class="anchor" aria-label="anchor" href="#macs3-functions"></a>
</h3>
<p>There are 13 functions imported from MACS3. Details of each function
can be checked from its manual.</p>
<table class="table">
<colgroup>
<col width="18%">
<col width="81%">
</colgroup>
<thead><tr class="header">
<th>Functions</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>callpeak</code></td>
<td>Main MACS3 Function to call peaks from alignment results.</td>
</tr>
<tr class="even">
<td><code>bdgpeakcall</code></td>
<td>Call peaks from bedGraph output.</td>
</tr>
<tr class="odd">
<td><code>bdgbroadcall</code></td>
<td>Call broad peaks from bedGraph output.</td>
</tr>
<tr class="even">
<td><code>bdgcmp</code></td>
<td>Comparing two signal tracks in bedGraph format.</td>
</tr>
<tr class="odd">
<td><code>bdgopt</code></td>
<td>Operate the score column of bedGraph file.</td>
</tr>
<tr class="even">
<td><code>cmbreps</code></td>
<td>Combine BEDGraphs of scores from replicates.</td>
</tr>
<tr class="odd">
<td><code>bdgdiff</code></td>
<td>Differential peak detection based on paired four bedGraph
files.</td>
</tr>
<tr class="even">
<td><code>filterdup</code></td>
<td>Remove duplicate reads, then save in BED/BEDPE format.</td>
</tr>
<tr class="odd">
<td><code>predictd</code></td>
<td>Predict d or fragment size from alignment results.</td>
</tr>
<tr class="even">
<td><code>pileup</code></td>
<td>Pileup aligned reads (single-end) or fragments (paired-end)</td>
</tr>
<tr class="odd">
<td><code>randsample</code></td>
<td>Randomly choose a number/percentage of total reads.</td>
</tr>
<tr class="even">
<td><code>refinepeak</code></td>
<td>Take raw reads alignment, refine peak summits.</td>
</tr>
<tr class="odd">
<td><code>callvar</code></td>
<td>Call variants in given peak regions from the alignment BAM
files.</td>
</tr>
<tr class="even">
<td><code>hmmratac</code></td>
<td>Dedicated peak calling based on Hidden Markov Model for ATAC-seq
data.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="function-callpeak">Function <code>callpeak</code><a class="anchor" aria-label="anchor" href="#function-callpeak"></a>
</h3>
<p>We have uploaded multipe test datasets from MACS to a data package
<code>MACSdata</code> in the <code>ExperimentHub</code>. For example,
Here we download a pair of single-end bed files to run the
<code>callpeak</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eh</span> <span class="op">&lt;-</span> <span class="fu">ExperimentHub</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ExperimentHub/man/ExperimentHub-class.html" class="external-link">ExperimentHub</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">eh</span> <span class="op">&lt;-</span> <span class="fu">AnnotationHub</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationHub/man/AnnotationHub-class.html" class="external-link">query</a></span><span class="op">(</span><span class="va">eh</span>, <span class="st">"MACSdata"</span><span class="op">)</span></span>
<span><span class="va">CHIP</span> <span class="op">&lt;-</span> <span class="va">eh</span><span class="op">[[</span><span class="st">"EH4558"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; see ?MACSdata and browseVignettes('MACSdata') for documentation</span></span>
<span><span class="co">#&gt; loading from cache</span></span>
<span><span class="va">CTRL</span> <span class="op">&lt;-</span> <span class="va">eh</span><span class="op">[[</span><span class="st">"EH4563"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; see ?MACSdata and browseVignettes('MACSdata') for documentation</span></span>
<span><span class="co">#&gt; loading from cache</span></span></code></pre></div>
<p>Here is an example to call narrow and broad peaks on the SE bed
files.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/callpeak.html">callpeak</a></span><span class="op">(</span><span class="va">CHIP</span>, <span class="va">CTRL</span>, gsize <span class="op">=</span> <span class="fl">5.2e7</span>, store_bdg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                name <span class="op">=</span> <span class="st">"run_callpeak_narrow0"</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                cutoff_analysis <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] </span></span>
<span><span class="co">#&gt; # Command line: </span></span>
<span><span class="co">#&gt; # ARGUMENTS LIST:</span></span>
<span><span class="co">#&gt; # name = run_callpeak_narrow0</span></span>
<span><span class="co">#&gt; # format = AUTO</span></span>
<span><span class="co">#&gt; # ChIP-seq file = ['/root/.cache/R/ExperimentHub/10ee667d0c_4601']</span></span>
<span><span class="co">#&gt; # control file = ['/root/.cache/R/ExperimentHub/10e4048cda8_4606']</span></span>
<span><span class="co">#&gt; # effective genome size = 5.20e+07</span></span>
<span><span class="co">#&gt; # band width = 300</span></span>
<span><span class="co">#&gt; # model fold = [5.0, 50.0]</span></span>
<span><span class="co">#&gt; # qvalue cutoff = 5.00e-02</span></span>
<span><span class="co">#&gt; # The maximum gap between significant sites is assigned as the read length/tag size.</span></span>
<span><span class="co">#&gt; # The minimum length of peaks is assigned as the predicted fragment length "d".</span></span>
<span><span class="co">#&gt; # Larger dataset will be scaled towards smaller dataset.</span></span>
<span><span class="co">#&gt; # Range for calculating regional lambda is: 1000 bps and 10000 bps</span></span>
<span><span class="co">#&gt; # Broad region calling is off</span></span>
<span><span class="co">#&gt; # Additional cutoff on fold-enrichment is: 0.10</span></span>
<span><span class="co">#&gt; # Paired-End mode is off</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 read tag files... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 read treatment tags... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] Detected format is: BED </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] * Input file is gzipped. </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1.2 read input tags... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] Detected format is: BED </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] * Input file is gzipped. </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 tag size is determined as 101 bps </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 tag size = 101.0 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1  total tags in treatment: 49622 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 user defined the maximum tags... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1  tags after filtering in treatment: 48047 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1  Redundant rate of treatment: 0.03 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1  total tags in control: 50837 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 user defined the maximum tags... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1  tags after filtering in control: 50783 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1  Redundant rate of control: 0.00 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 finished! </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 Build Peak Model... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 looking for paired plus/minus strand peaks... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 Total number of paired peaks: 469 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 Model building with cross-correlation: Done </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 finished! </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 predicted fragment length is 228 bps </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 alternative fragment length(s) may be 228 bps </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2.2 Generate R script for model : /tmp/RtmprpXrdd/run_callpeak_narrow0_model.r </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3 Call peaks... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3 Pre-compute pvalue-qvalue table... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3 Cutoff vs peaks called will be analyzed! </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3 Analysis of cutoff vs num of peaks or total length has been saved in b'/tmp/RtmprpXrdd/run_callpeak_narrow0_cutoff_analysis.txt' </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3 In the peak calling step, the following will be performed simultaneously: </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3   Write bedGraph files for treatment pileup (after scaling if necessary)... run_callpeak_narrow0_treat_pileup.bdg </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3   Write bedGraph files for control lambda (after scaling if necessary)... run_callpeak_narrow0_control_lambda.bdg </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3   Pileup will be based on sequencing depth in treatment. </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3 Call peaks for each chromosome... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #4 Write output xls file... /tmp/RtmprpXrdd/run_callpeak_narrow0_peaks.xls </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #4 Write peak in narrowPeak format file... /tmp/RtmprpXrdd/run_callpeak_narrow0_peaks.narrowPeak </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #4 Write summits bed file... /tmp/RtmprpXrdd/run_callpeak_narrow0_summits.bed </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] Done!</span></span>
<span><span class="va">cp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/callpeak.html">callpeak</a></span><span class="op">(</span><span class="va">CHIP</span>, <span class="va">CTRL</span>, gsize <span class="op">=</span> <span class="fl">5.2e7</span>, store_bdg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                name <span class="op">=</span> <span class="st">"run_callpeak_broad"</span>, outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                broad <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>Here are the outputs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cp1</span></span>
<span><span class="co">#&gt; macsList class</span></span>
<span><span class="co">#&gt; $outputs:</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_narrow0_control_lambda.bdg</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_narrow0_cutoff_analysis.txt</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_narrow0_model.r</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_narrow0_peaks.narrowPeak</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_narrow0_peaks.xls</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_narrow0_summits.bed</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_narrow0_treat_pileup.bdg </span></span>
<span><span class="co">#&gt; $arguments: tfile, cfile, gsize, outdir, name, store_bdg, cutoff_analysis </span></span>
<span><span class="co">#&gt; $log:</span></span>
<span><span class="co">#&gt;  INFO  @ 18 Sep 2024 20:59:11: [686 MB] </span></span>
<span><span class="co">#&gt;  # Command line: </span></span>
<span><span class="co">#&gt;  # ARGUMENTS LIST:</span></span>
<span><span class="co">#&gt;  # name = run_callpeak_narrow0</span></span>
<span><span class="co">#&gt;  # format = AUTO</span></span>
<span><span class="co">#&gt; ...</span></span>
<span><span class="va">cp2</span></span>
<span><span class="co">#&gt; macsList class</span></span>
<span><span class="co">#&gt; $outputs:</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_broad_control_lambda.bdg</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_broad_model.r</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_broad_peaks.broadPeak</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_broad_peaks.gappedPeak</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_broad_peaks.xls</span></span>
<span><span class="co">#&gt;  /tmp/RtmprpXrdd/run_callpeak_broad_treat_pileup.bdg </span></span>
<span><span class="co">#&gt; $arguments: tfile, cfile, gsize, outdir, name, store_bdg, broad </span></span>
<span><span class="co">#&gt; $log:</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-macslist-class">The <code>macsList</code> class<a class="anchor" aria-label="anchor" href="#the-macslist-class"></a>
</h3>
<p>The <code>macsList</code> is designed to contain everything of an
execution, including function, inputs, outputs and logs, for the purpose
of reproducibility.</p>
<p>For example, we can the function and input arguments.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cp1</span><span class="op">$</span><span class="va">arguments</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; callpeak</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tfile</span></span>
<span><span class="co">#&gt; CHIP</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cfile</span></span>
<span><span class="co">#&gt; CTRL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gsize</span></span>
<span><span class="co">#&gt; [1] 5.2e+07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $outdir</span></span>
<span><span class="co">#&gt; tempdir()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $name</span></span>
<span><span class="co">#&gt; [1] "run_callpeak_narrow0"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $store_bdg</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cutoff_analysis</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>The files of all the outputs are collected.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cp1</span><span class="op">$</span><span class="va">outputs</span></span>
<span><span class="co">#&gt; [1] "/tmp/RtmprpXrdd/run_callpeak_narrow0_control_lambda.bdg" </span></span>
<span><span class="co">#&gt; [2] "/tmp/RtmprpXrdd/run_callpeak_narrow0_cutoff_analysis.txt"</span></span>
<span><span class="co">#&gt; [3] "/tmp/RtmprpXrdd/run_callpeak_narrow0_model.r"            </span></span>
<span><span class="co">#&gt; [4] "/tmp/RtmprpXrdd/run_callpeak_narrow0_peaks.narrowPeak"   </span></span>
<span><span class="co">#&gt; [5] "/tmp/RtmprpXrdd/run_callpeak_narrow0_peaks.xls"          </span></span>
<span><span class="co">#&gt; [6] "/tmp/RtmprpXrdd/run_callpeak_narrow0_summits.bed"        </span></span>
<span><span class="co">#&gt; [7] "/tmp/RtmprpXrdd/run_callpeak_narrow0_treat_pileup.bdg"</span></span></code></pre></div>
<p>The <code>log</code> is especially important for <code>MACS</code> to
check. Detailed information was given in the log when running.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">cp1</span><span class="op">$</span><span class="va">log</span>, collapse<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] </span></span>
<span><span class="co">#&gt; # Command line: </span></span>
<span><span class="co">#&gt; # ARGUMENTS LIST:</span></span>
<span><span class="co">#&gt; # name = run_callpeak_narrow0</span></span>
<span><span class="co">#&gt; # format = AUTO</span></span>
<span><span class="co">#&gt; # ChIP-seq file = ['/root/.cache/R/ExperimentHub/10ee667d0c_4601']</span></span>
<span><span class="co">#&gt; # control file = ['/root/.cache/R/ExperimentHub/10e4048cda8_4606']</span></span>
<span><span class="co">#&gt; # effective genome size = 5.20e+07</span></span>
<span><span class="co">#&gt; # band width = 300</span></span>
<span><span class="co">#&gt; # model fold = [5.0, 50.0]</span></span>
<span><span class="co">#&gt; # qvalue cutoff = 5.00e-02</span></span>
<span><span class="co">#&gt; # The maximum gap between significant sites is assigned as the read length/tag size.</span></span>
<span><span class="co">#&gt; # The minimum length of peaks is assigned as the predicted fragment length "d".</span></span>
<span><span class="co">#&gt; # Larger dataset will be scaled towards smaller dataset.</span></span>
<span><span class="co">#&gt; # Range for calculating regional lambda is: 1000 bps and 10000 bps</span></span>
<span><span class="co">#&gt; # Broad region calling is off</span></span>
<span><span class="co">#&gt; # Additional cutoff on fold-enrichment is: 0.10</span></span>
<span><span class="co">#&gt; # Paired-End mode is off</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 read tag files... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 read treatment tags... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] Detected format is: BED </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] * Input file is gzipped. </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1.2 read input tags... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] Detected format is: BED </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] * Input file is gzipped. </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 tag size is determined as 101 bps </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 tag size = 101.0 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1  total tags in treatment: 49622 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 user defined the maximum tags... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1  tags after filtering in treatment: 48047 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1  Redundant rate of treatment: 0.03 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1  total tags in control: 50837 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 user defined the maximum tags... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1  tags after filtering in control: 50783 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1  Redundant rate of control: 0.00 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #1 finished! </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 Build Peak Model... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 looking for paired plus/minus strand peaks... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 Total number of paired peaks: 469 </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 Model building with cross-correlation: Done </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 finished! </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 predicted fragment length is 228 bps </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2 alternative fragment length(s) may be 228 bps </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #2.2 Generate R script for model : /tmp/RtmprpXrdd/run_callpeak_narrow0_model.r </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3 Call peaks... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3 Pre-compute pvalue-qvalue table... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3 Cutoff vs peaks called will be analyzed! </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3 Analysis of cutoff vs num of peaks or total length has been saved in b'/tmp/RtmprpXrdd/run_callpeak_narrow0_cutoff_analysis.txt' </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3 In the peak calling step, the following will be performed simultaneously: </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3   Write bedGraph files for treatment pileup (after scaling if necessary)... run_callpeak_narrow0_treat_pileup.bdg </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3   Write bedGraph files for control lambda (after scaling if necessary)... run_callpeak_narrow0_control_lambda.bdg </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3   Pileup will be based on sequencing depth in treatment. </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #3 Call peaks for each chromosome... </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #4 Write output xls file... /tmp/RtmprpXrdd/run_callpeak_narrow0_peaks.xls </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #4 Write peak in narrowPeak format file... /tmp/RtmprpXrdd/run_callpeak_narrow0_peaks.narrowPeak </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] #4 Write summits bed file... /tmp/RtmprpXrdd/run_callpeak_narrow0_summits.bed </span></span>
<span><span class="co">#&gt; INFO  @ 18 Sep 2024 20:59:11: [686 MB] Done!</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<p>More details about <code>MACS3</code> can be found: <a href="https://macs3-project.github.io/MACS/" class="external-link uri">https://macs3-project.github.io/MACS/</a>.</p>
</div>
<div class="section level2">
<h2 id="sessioninfo">SessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: aarch64-unknown-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/aarch64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/aarch64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Etc/UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] MACSdata_1.10.0  MACSr_1.11.3     BiocStyle_2.30.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] KEGGREST_1.45.1         dir.expiry_1.13.0       xfun_0.47              </span></span>
<span><span class="co">#&gt;  [4] bslib_0.8.0             htmlwidgets_1.6.4       Biobase_2.65.1         </span></span>
<span><span class="co">#&gt;  [7] lattice_0.22-6          vctrs_0.6.5             tools_4.4.1            </span></span>
<span><span class="co">#&gt; [10] generics_0.1.3          stats4_4.4.1            curl_5.2.2             </span></span>
<span><span class="co">#&gt; [13] parallel_4.4.1          tibble_3.2.1            fansi_1.0.6            </span></span>
<span><span class="co">#&gt; [16] AnnotationDbi_1.67.0    RSQLite_2.3.7           blob_1.2.4             </span></span>
<span><span class="co">#&gt; [19] pkgconfig_2.0.3         Matrix_1.7-0            dbplyr_2.5.0           </span></span>
<span><span class="co">#&gt; [22] desc_1.4.3              S4Vectors_0.43.2        GenomeInfoDbData_1.2.12</span></span>
<span><span class="co">#&gt; [25] lifecycle_1.0.4         compiler_4.4.1          textshaping_0.4.0      </span></span>
<span><span class="co">#&gt; [28] Biostrings_2.73.1       GenomeInfoDb_1.41.1     htmltools_0.5.8.1      </span></span>
<span><span class="co">#&gt; [31] sass_0.4.9              yaml_2.3.10             crayon_1.5.3           </span></span>
<span><span class="co">#&gt; [34] pkgdown_2.1.0           pillar_1.9.0            jquerylib_0.1.4        </span></span>
<span><span class="co">#&gt; [37] cachem_1.1.0            mime_0.12               ExperimentHub_2.13.1   </span></span>
<span><span class="co">#&gt; [40] AnnotationHub_3.13.3    basilisk_1.17.2         tidyselect_1.2.1       </span></span>
<span><span class="co">#&gt; [43] digest_0.6.37           purrr_1.0.2             dplyr_1.1.4            </span></span>
<span><span class="co">#&gt; [46] bookdown_0.40           BiocVersion_3.20.0      fastmap_1.2.0          </span></span>
<span><span class="co">#&gt; [49] grid_4.4.1              cli_3.6.3               magrittr_2.0.3         </span></span>
<span><span class="co">#&gt; [52] utf8_1.2.4              withr_3.0.1             UCSC.utils_1.1.0       </span></span>
<span><span class="co">#&gt; [55] filelock_1.0.3          rappdirs_0.3.3          bit64_4.0.5            </span></span>
<span><span class="co">#&gt; [58] XVector_0.45.0          rmarkdown_2.28          httr_1.4.7             </span></span>
<span><span class="co">#&gt; [61] bit_4.0.5               reticulate_1.39.0       ragg_1.3.3             </span></span>
<span><span class="co">#&gt; [64] png_0.1-8               memoise_2.0.1           evaluate_1.0.0         </span></span>
<span><span class="co">#&gt; [67] knitr_1.48              IRanges_2.39.2          basilisk.utils_1.17.3  </span></span>
<span><span class="co">#&gt; [70] BiocFileCache_2.13.0    rlang_1.1.4             Rcpp_1.0.13            </span></span>
<span><span class="co">#&gt; [73] glue_1.7.0              DBI_1.2.3               BiocManager_1.30.25    </span></span>
<span><span class="co">#&gt; [76] BiocGenerics_0.51.1     jsonlite_1.8.8          R6_2.5.1               </span></span>
<span><span class="co">#&gt; [79] zlibbioc_1.51.1         systemfonts_1.1.0       fs_1.6.4</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Philippa Doherty, Qiang Hu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
